{%  extends "bilanci/confronti_home.html" %}
{% load staticfiles %}
{% load confronti_helpbox %}
{% load confronti_parameter_list %}

{% block page_title %}
    Confronto Comune {{ territorio_1.denominazione }} con {{ territorio_2.denominazione }} su {{ indicator.denominazione }}
{% endblock %}

{% block helpbox_1 %}
    {% confronti_helpbox territorio_1 contesto_1 %}
{% endblock %}

{% block helpbox_2 %}
    {% confronti_helpbox territorio_2  contesto_2 %}
{% endblock %}

{% block confronti_parameter_menu_toggle %}
    <div class="row">
        <div class="col-sm-4">
            <a href="" id="toggle-menu" role="button">
                <span class="icon sprite-toggle-menu"></span>
            </a>
        </div>
    </div>
{% endblock %}

{# comparison list menu  #}
{% block confronti_parameter_menu %}
    <aside id="sidebar" class="confronti_parameter_container" class="hidden">
        {% confronti_parameter_list 'indicatori' indicator_list territorio_1.slug territorio_2.slug  %}
        {% confronti_parameter_list 'entrate' entrate_list territorio_1.slug territorio_2.slug %}
        {% confronti_parameter_list 'spese' spese_list territorio_1.slug territorio_2.slug %}

    </aside>
{% endblock %}

{% block results %}
    <div id="results" class="row">
        <div class="col-md-12">
            <div class="panel panel-default panel-nobg">
                <div class="panel-heading clearfix">
                    <h3 class="panel-title">{{ parameter_type }}</h3>
                    <p> {{ parameter_type }}<span class="sep">â€º</span> {{ indicator.denominazione|upper }}</p>
                </div>
                <div class="panel-body">
                    <div class='col-md-12'>
                        {% include 'commons/_lines_chart_over_the_years.html' %}
                    </div>
                </div>
            </div>
        </div>
    </div><!-- /#results -->
{% endblock %}


{% block extra_js %}

    <script src="{% static 'scripts/confronti_utils.js' %}" type="text/javascript"></script>

    <script type="text/javascript">

        $(document).ready(function(){

            /*
            opens by default the indicator menu on page load
            */

            var $sidebar = $( '#sidebar' ),
                $content = $( '#content' );

            var clss = {
                btn: {
                    on: 'active'
                },
                content: {
                    on: 'col-sm-12',
                    off: 'col-sm-8 col-sm-push-4'
                },
                sidebar: {
                    on: 'col-sm-4 col-sm-pull-8',
                    off: 'hidden'
                }
            };

            $sidebar
                .removeClass( clss.sidebar.off )
                .addClass( clss.sidebar.on );
            $content
                .removeClass( clss.content.on )
                .addClass( clss.content.off );
            $( '#toggle-menu' ).addClass( clss.btn.on );


            /*
            initialize fake submit button url and side menu url
             */


            $("#id_territorio_1").on("click", function(){ changeConfrontiUrl();});
            $("#id_territorio_2").on("click", function(){ changeConfrontiUrl();});


            changeConfrontiUrl();

            $("#confronti_submit_btn").on('click', function(e) {
                submitButtonConfronti(e);
            });
        });

    </script>

    <!-- visup js -->
    <script src="{% static 'scripts/visup/all.js' %}" type="text/javascript"></script>
    <script src="{% static 'scripts/linegraph_utils.js' %}" type="text/javascript"></script>

    <script type="text/javascript">

        //    initialize the line graph with data

        d3.json("{% url 'confronti-data-json' territorio_1_opid=territorio_1.op_id territorio_2_opid=territorio_2.op_id parameter_type=parameter_type parameter_slug=indicator.slug %}",
            function (i) {
            chart.data(i)
        });




    </script>

    <!-- / visup js -->

{% endblock %}

{% block extra_css %}
{#    <!-- visup css-->#}
    <link href='http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Lato' rel='stylesheet' type='text/css'>
    <link href="{% static 'css/visup/visup-style.css' %}" media="screen" rel="stylesheet" type="text/css" />

{#    <!-- / visup css-->#}
{% endblock %}